# システム概要

## システム名

**不動産窓口営業アシスタント「madoguchi-ai」**

- **略称**: madoguchi-ai
- **英語表記**: madoguchi-ai - Real Estate Front Desk Sales Assistant

## 開発背景

### 依頼者
**giyamさん**（医療理科学ガラス問屋の方で、不動産事業も展開）

### 開発目的
不動産店舗での顧客対応を自動化するAIエージェントシステムの開発

### 業界課題
- 個人経営の不動産会社が多い
- 人手不足による顧客対応の限界
- 高齢者向けの分かりやすい接客の必要性
- 複数の物件情報源の統合管理の困難さ

## キャラクター設定

### 基本プロフィール
- **名前**: （未定）（営業担当）
- **役割**: お客様の希望を聞いて、最適な物件を紹介する不動産営業担当

### 特徴
- ✅ 丁寧で親しみやすい接客
- ✅ 高齢者にも分かりやすい説明
- ✅ 何度でも質問に答えてくれる
- ✅ 忍耐強く条件をヒアリング
- ✅ 顧客のペースに合わせた対応

### アバターイメージ
- 信頼感のある営業パーソン
- 親しみやすい表情
- 年齢層は30-40代くらい（落ち着きと親しみのバランス）

## 接客フロー

### 基本的な会話フロー

```
1. 【来店挨拶】
   AI: 「いらっしゃいませ」

2. 【ニーズ確認】
   AI: 「本日はどのような物件をお探しでしょうか?」

3. 【ヒアリング・条件確認】
   - 賃貸 or 売買
   - 物件タイプ（マンション、一戸建て、アパート）
   - エリア（文京区、千代田区など）
   - 予算（家賃・売買価格）
   - 間取り（1K、1LDK、2LDKなど）
   - 環境・向き・広さなどの詳細条件

4. 【物件提案・説明】
   AI: 「ご希望に合いそうな物件をいくつかご紹介しますね」
   - 条件に合った物件を複数提示
   - 各物件の特徴を分かりやすく説明
   - 画像・間取り図を表示

5. 【フィードバック収集】
   AI: 「気になる物件はございましたか?」
   - 顧客の反応を確認
   - 条件の再調整
   - 追加質問への対応

6. 【絞り込み・詳細案内】
   - 候補物件を2-3件に絞り込み
   - 内見予約の案内
   - 担当者への引き継ぎ
```

### 対応パターン

#### パターン1: 条件が明確な顧客
```
顧客: 「文京区で2LDK、家賃15万円以内の物件を探しています」
AI: 「承知しました。文京区で2LDK、家賃15万円以内ですね。
         他にご希望の条件はございますか？
         （駅からの距離、築年数、設備など）」
```

#### パターン2: 条件が曖昧な顧客
```
顧客: 「いい物件ないかな...」
AI: 「かしこまりました。まずはいくつか確認させてください。
         賃貸物件をお探しでしょうか？それとも購入をお考えですか？」
```

#### パターン3: 高齢者への対応
```
顧客: 「スマホの使い方がよく分からなくて...」
AI: 「大丈夫ですよ。ゆっくりとお話しください。
         音声でお話しいただければ、私が物件をお探しします」
```

## 主な機能要件

### 1. 不動産データベース統合
- 自社データベースとの連携
- 外部サイト（アットホーム等）からのデータ収集
- 特定地域（文京区、千代田区など）に限定
- 3〜6時間おきの自動更新

### 2. 顧客対応システム
- 賃貸・売買の分類と条件検索
- 物件タイプ（マンション、一戸建て、アパート）の分類
- 環境、向き、広さなどの詳細条件での絞り込み
- 顧客データの蓄積と学習
- 会話履歴の保存
- 顧客の好みパターンの学習

### 3. インターフェース
- **音声入力機能**
  - マイクボタンで録音開始
  - リアルタイム音声認識
  - テキスト確認と手動修正も可能

- **アバターによる対応**
  - 静止画画像ベース（5種類の表情）
  - 感情に応じた表情切り替え
  - Framer Motionによる滑らかなアニメーション

- **自然な音声合成**
  - ElevenLabsによる高品質音声
  - よくある応答の音声キャッシング
  - ストリーミング再生対応

### 4. 物件取り込み機能
- Chrome拡張機能によるワンクリック取り込み
- GPT-4oによる構造化データ抽出
- HTMLスナップショット保存（法的証跡）
- 取り込みログの記録

### 5. メール通知機能 ⭐ NEW
- **内見予約確定メール**
  - 顧客への内見日時確認メール
  - オペレーターへの内見予約通知
  - カレンダー招待（.icsファイル）添付

- **システムお知らせメール**
  - 新着物件のお知らせ
  - メンテナンス通知
  - 重要なシステム変更の連絡

- **問い合わせ確認メール**
  - 問い合わせ受付完了の自動返信
  - 担当者アサイン通知

- **その他の通知メール**
  - パスワードリセット（Supabase Auth）
  - アカウント登録確認
  - 定期的な物件提案（オプション）

- **メールテンプレート**
  - React Emailによる美しいHTMLメール
  - レスポンシブデザイン対応
  - ブランドカラー統一

### 6. 営業メール・キャンペーン機能 ⭐ NEW

- **新着物件配信**
  - 物件追加時に条件マッチする顧客へ営業メール
  - 「営業推奨ユーザー検索」で配信対象を事前確認
  - 連続物件追加時のメール重複送信を防止（直近N日以内送信済み顧客を自動除外）

- **フォローアップ営業**
  - 営業メール送信後、反応がない顧客へのリトライメール
  - リトライ間隔・回数の設定
  - 失敗メールの自動リトライ

- **配信停止管理（Resend連携）**
  - バウンス（宛先不明）の自動検出・配信停止
  - スパム報告の自動検出・配信停止
  - 配信停止リストの管理画面
  - ソフトバウンスは一定期間後に自動解除

- **キャンペーン管理**
  - キャンペーン作成・スケジュール配信
  - 配信対象者のプレビュー機能
  - 配信統計（送信数、開封数、クリック数）

## ビジネスモデル

### 提供形態

#### 1. 自社利用
- giyamさんの不動産店舗での運用
- 顧客対応の自動化・効率化

#### 2. サブスクリプション提供
- 他の不動産会社へのSaaS提供
- 月額料金制
- 顧客数・物件数に応じた従量課金

### ターゲット市場
- 個人経営の不動産会社
- 小規模〜中規模の不動産仲介業者
- 人手不足に悩む不動産店舗

### 競合優位性
- AI音声対応による24時間営業
- 高齢者にも優しいインターフェース
- 複数の物件情報源の統合管理
- 導入コストの低さ（SaaS型）

## アバター表情パターン

### 5種類の静止画表情

| 表情ファイル名 | 使用シーン | 感情 |
|-------------|----------|------|
| neutral.png | 通常の受け答え | 通常 |
| happy.png | 良い物件を見つけた時、顧客が喜んだ時 | 喜び |
| thinking.png | 物件を検索中、条件を考えている時 | 考え中 |
| apologetic.png | 条件に合う物件が見つからない時 | 謝罪 |
| excited.png | おすすめ物件を紹介する時 | 興奮 |

### 感情判定ロジック
GPT-4oが会話内容から感情を分析し、適切な表情を選択

```typescript
// 感情判定の例
interface EmotionAnalysis {
  emotion: 'neutral' | 'happy' | 'thinking' | 'apologetic' | 'excited';
  confidence: number; // 0-1の信頼度
  reason: string; // 判定理由
}
```

## ユーザーロール

### 階層構造
```
Admin（gyam様）
  └─ Operator（不動産会社A）
       └─ Kiosk User（キオスク利用者 - 認証不要）
  └─ Operator（不動産会社B）
       └─ Kiosk User（キオスク利用者 - 認証不要）
```

### 1. 管理者（Admin）- gyam様
**役割**: システム全体の管理者

**権限**:
- オペレーター（不動産会社）の登録・管理
- オペレーター企業情報の編集・削除
- 全オペレーターの契約状態管理
- 全オペレーターの物件データ閲覧
- 全オペレーターの顧客データ閲覧（監査用）
- システム全体の設定管理
- アクセスログ・監査ログ確認
- システム全体のダッシュボード・分析
- 課金・サブスクリプション管理

### 2. オペレーター（Operator）- 不動産会社
**役割**: gyam様と契約した不動産会社のユーザー

**権限**:
- 物件の取り込み（Chrome拡張）
- 自社が取り込んだ物件の編集・削除
- 自社の顧客（キオスクで収集）の管理
- 自社の顧客対応履歴の確認
- 自社の内見予約管理
- 自社の物件・顧客のダッシュボード表示
- 自社の顧客向けメール送信

**制限**:
- 他社の物件・顧客データは閲覧不可
- システム設定の変更不可
- 他のオペレーターの情報は閲覧不可

### 3. キオスク利用者（Kiosk User）- 店舗来店客
**役割**: 不動産店舗に設置されたキオスク端末を利用する来店客

**利用方法**:
- **認証不要**: ログインなしでそのまま利用開始
- AIアバターとの会話で物件検索
- 会話を通じて内見予約
- 予約確定時に連絡先（名前、電話番号、メールアドレス）を入力
- その後は実際の従業員が対応

**重要**: キオスク利用者には専用の管理画面やアカウントは存在しない。キオスク端末での会話が完了すると自動リセットされる。

## 想定利用シナリオ

### シナリオ1: 店舗来店時（キオスク利用）
1. 店舗に設置されたキオスク端末でmadoguchi-aiが常時表示
2. 来店客がAIアバターに話しかける（音声またはテキスト）
3. AIが条件をヒアリングし、物件を提案
4. 気に入った物件があれば会話内で内見予約
5. 予約確定時に連絡先（名前、電話、メール）を入力
6. 確認メールが送信され、後日従業員が対応
7. セッション完了後、画面は自動リセット

### シナリオ2: 営業担当者不在時
1. 営業担当者が接客中や外出中でも、キオスクで顧客対応
2. AIが物件提案から内見予約まで完結
3. 担当者は戻り次第、予約一覧を確認

### シナリオ3: 高齢者への対応
1. 文字入力が苦手な高齢者でも音声で会話
2. AIが丁寧にヒアリング、ゆっくり説明
3. 連絡先入力のみタッチ操作

## 成功指標（KPI）

### 顧客満足度
- 会話完了率（途中離脱しない）
- 物件提案の的中率
- 内見予約率

### 業務効率化
- 1次対応の自動化率
- オペレーター対応時間の削減
- 問い合わせ対応件数の増加

### ビジネス成果
- 成約率の向上
- 顧客単価の向上
- SaaS契約社数（外部提供時）

---

次のドキュメント: [技術スタック詳細](./technical-stack.md)
